rules_version='2'

service cloud.firestore {
  match /databases/{database}/documents {
    // 一時的なテスト用ルール - 認証済みユーザーに全アクセス許可
    match /pokepastes/{pokePasteId} {
      allow read, write: if request.auth != null;
    }

    // その他のドキュメントへのアクセスは拒否
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

// PokePasteデータの妥当性をチェックする関数
function validatePokePasteData(data) {
  return data.keys().hasAll(['teamName', 'author', 'pokemon', 'url', 'userId', 'createdAt', 'updatedAt'])
    && data.teamName is string
    && data.author is string
    && data.pokemon is list
    && data.url is string
    && data.userId is string
    && data.createdAt is timestamp
    && data.updatedAt is timestamp
    && data.pokemon.size() <= 6;  // 最大6匹まで
}
