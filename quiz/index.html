<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <title>Java Silver 模擬問題</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="./styles.css" />
    </head>
    <body>
        <span id="timer" class="timer-fixed">経過時間: 0分0秒</span>

        <main class="container">
            <section class="controls">
                <h2>Java Silver 模擬問題</h2>
            </section>

            <nav class="tabs" role="tablist" aria-label="画面切替">
                <button
                    id="tab-quiz"
                    class="tab-btn active"
                    role="tab"
                    aria-selected="true"
                    aria-controls="panel-quiz"
                >
                    問題を解く
                </button>
                <button
                    id="tab-analytics"
                    class="tab-btn"
                    role="tab"
                    aria-selected="false"
                    aria-controls="panel-analytics"
                >
                    回答結果を分析
                </button>
            </nav>

            <section id="panel-quiz" class="tab-panel" role="tabpanel" aria-labelledby="tab-quiz">
                <section class="controls">
                    <label for="fileSelect">出題範囲：</label>
                    <select id="fileSelect">
                        <option value="JAVA_SILVER_1Z0_815_JPN_ALL">全て</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_01">
                            第1章 簡単なJavaプログラムの作成
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_02">
                            第2章 Javaの基本データ型と文字列操作
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_03">第3章 演算子と判定構造</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_04">第4章 制御構造</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_05">第5章 配列の操作</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_06">
                            第6章 インスタンスとメソッド
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_07">
                            第7章 クラスの継承、インタフェース、抽象クラス
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_08">
                            第8章 関数型インタフェース、ラムダ式
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_09">第9章 API</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_10">第10章 例外処理</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_11">
                            第11章 モジュールシステム
                        </option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_12">第12章 総仕上げ問題①</option>
                        <option value="JAVA_SILVER_1Z0_815_JPN_13">第13章 総仕上げ問題②</option>
                    </select>
                    <input type="file" id="fileInput" accept=".json" hidden />
                    <span id="fileCount" class="sub"></span>
                </section>

                <section class="controls">
                    <div class="order-mode">
                        <label for="questionOrderMode">出題方法：</label>
                        <select id="questionOrderMode">
                            <option value="random">ランダム</option>
                            <option value="ordered">番号順</option>
                        </select>
                    </div>
                </section>

                <section class="controls">
                    <!-- ランダムのときだけ表示 -->
                    <div id="randomControls">
                        <label for="questionCount">出題数：</label>
                        <input id="questionCount" type="number" min="1" step="1" value="5" />
                        <label><input id="adaptiveMode" type="checkbox" checked /> 弱点優先</label>
                        <label class="sub" style="margin-left: 8px">
                            重点度(0〜2):
                            <input
                                id="adaptiveStrength"
                                type="number"
                                min="0"
                                max="2"
                                step="0.1"
                                value="1.0"
                                style="width: 70px"
                            />
                        </label>
                    </div>

                    <!-- 番号順のときだけ表示 -->
                    <div id="orderedControls" class="hidden">
                        <div id="orderRangeGroup" class="order-range">
                            <span>問題No：</span>
                            <label>
                                <input
                                    id="orderFrom"
                                    type="number"
                                    min="1"
                                    value="1"
                                    inputmode="numeric"
                                />
                            </label>
                            <label>～</label>
                            <label>
                                <input
                                    id="orderTo"
                                    type="number"
                                    min="1"
                                    value="10"
                                    inputmode="numeric"
                                />
                            </label>
                            <label>を出題する</label>
                        </div>
                    </div>
                </section>

                <section class="controls">
                    <label>オプション：</label>
                    <label>
                        <input id="randomizeChoices" type="checkbox" checked />
                        選択肢をランダムに並べ替える
                    </label>
                    <label>
                        <input id="showQuestionId" type="checkbox" />
                        問題IDを表示
                    </label>
                </section>

                <section class="controls">
                    <button id="loadBtn" class="primary">出題</button>
                    <button id="resetBtn" class="ghost" disabled>リセット</button>
                    <span id="status" class="status" aria-live="polite"></span>
                </section>

                <section id="resultArea" class="result-area" aria-live="polite" hidden>
                    <h2>採点結果</h2>
                    <p id="scoreText"></p>
                    <!-- プログレスバー -->
                    <div class="progress">
                        <div id="progressBar" class="progress-bar"></div>
                    </div>
                    <p id="evalText"></p>
                    <!-- 評価メッセージ -->
                    <details hidden>
                        <summary>解説をすべて表示/非表示</summary>
                        <div id="explanations"></div>
                    </details>
                </section>

                <section id="quizArea" class="quiz-area" aria-live="polite"></section>

                <section id="gradeArea" class="grade-area" aria-live="polite" hidden>
                    <button id="gradeBtn" class="ok" disabled>採点する</button>
                </section>
            </section>

            <section
                id="panel-analytics"
                class="tab-panel hidden"
                role="tabpanel"
                aria-labelledby="tab-analytics"
            >
                <section id="historyArea" class="result-area" aria-live="polite">
                    <h2>過去の回答</h2>
                    <div class="history-controls">
                        <button id="refreshHistoryBtn" class="secondary">再読込</button>
                        <button id="clearHistoryBtn" class="ghost">全削除</button>
                        <button id="exportHistoryBtn" class="secondary" title="履歴をJSONで保存">
                            エクスポート
                        </button>
                        <button
                            id="importHistoryBtn"
                            class="secondary"
                            title="JSONから履歴を読み込む"
                        >
                            インポート
                        </button>
                        <input
                            id="importHistoryInput"
                            type="file"
                            accept="application/json"
                            hidden
                        />
                    </div>
                    <div id="historyList" class="history-list"></div>
                </section>

                <section id="trendArea" class="result-area" aria-live="polite">
                    <h2>正答率の推移（直近20回）</h2>
                    <div id="trendChart" class="trend-chart"></div>
                </section>

                <section id="analysisArea" class="result-area" aria-live="polite">
                    <h2>問題別分析</h2>
                    <div class="analysis-controls">
                        <button id="analyzeBtn" class="secondary">分析を更新</button>
                        <label class="sub">
                            低正答率しきい値:
                            <input
                                id="lowRateThreshold"
                                type="number"
                                min="0"
                                max="100"
                                step="1"
                                value="80"
                                style="width: 80px; margin-left: 6px"
                            />
                            %
                        </label>
                    </div>

                    <div id="analysisTableWrap" hidden></div>

                    <div class="panel">
                        <h3>ヒートマップ</h3>
                        <div id="heatmap" class="heatmap"></div>
                    </div>

                    <div class="panel">
                        <h3>カテゴリ別 正答率</h3>
                        <div id="prefixStatsWrap"></div>
                    </div>

                    <div class="panel" hidden>
                        <h3>正答率・横棒グラフ</h3>
                        <div id="barChart" class="bar-chart"></div>
                    </div>

                    <div class="analysis-panels">
                        <div class="panel">
                            <h3>正答率ランキング（上位）</h3>
                            <ol id="rankTop"></ol>
                        </div>
                        <div class="panel">
                            <h3>正答率ランキング（下位）</h3>
                            <ol id="rankBottom"></ol>
                        </div>
                    </div>
                </section>
            </section>
        </main>

        <script src="./Silver_01.js"></script>
        <script src="./Silver_02.js"></script>
        <script src="./Silver_03.js"></script>
        <script src="./Silver_04.js"></script>
        <script src="./Silver_05.js"></script>
        <script src="./Silver_06.js"></script>
        <script src="./Silver_07.js"></script>
        <script src="./Silver_08.js"></script>
        <script src="./Silver_09.js"></script>
        <script src="./Silver_10.js"></script>
        <script src="./Silver_11.js"></script>
        <script src="./Silver_12.js"></script>
        <script src="./Silver_13.js"></script>
        <script src="./questions_data.js"></script>
        <script src="./app.js" defer></script>
    </body>
</html>
